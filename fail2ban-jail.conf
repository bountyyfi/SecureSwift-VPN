# Fail2Ban jail configuration for SecureSwift VPN
# Add this to: /etc/fail2ban/jail.local
#
# After adding this configuration:
#   sudo systemctl restart fail2ban
#   sudo fail2ban-client status secureswift

[secureswift]
enabled  = true
port     = 51820
protocol = udp
filter   = secureswift
logpath  = /var/log/secureswift-auth.log
maxretry = 5
findtime = 600
bantime  = 3600
action   = iptables-allports[name=secureswift]

# Configuration explanation:
# - enabled:   Activate this jail
# - port:      VPN port (default 51820)
# - protocol:  UDP protocol
# - filter:    Use secureswift.conf filter
# - logpath:   SecureSwift authentication log file
# - maxretry:  Ban after 5 failures
# - findtime:  Within 10 minutes (600 seconds)
# - bantime:   Ban for 1 hour (3600 seconds)
# - action:    Block all ports for offending IP

# Optional: Permanent ban after repeated offenses
[secureswift-aggressive]
enabled  = true
port     = 51820
protocol = udp
filter   = secureswift
logpath  = /var/log/secureswift-auth.log
maxretry = 3
findtime = 3600
bantime  = -1
action   = iptables-allports[name=secureswift-perm]

# Aggressive mode: Ban permanently after 3 failures in 1 hour
